## Краткий тур по базе данных
<hr/>

## Сущности
1) ### Пользователь:
<span style="color:orange">__id__</span> - *уникальный идентификатор* <br/>
__fio__ - *фамилия имя отчество* <br/>
__email__ - *электронный адрес* <br/>
__phone__ - *номер телефона* <br/>
__birth_date__ - *дата рождения* <br/>
__password__ - *хешированный пароль*<br/>

2) ### Счет:
<span style="color:orange">__id__</span> - *уникальный идентификатор* <br/>
<span style="color:green">__user_id__</span> - *идентификатор владельца счета* <br/>
__balance__ - *состояние счета* <br/>
__is_active__ - *активен ли счет* <br/>
__create_date__ - *дата создания счета* <br/>

3) ### Карта:
<span style="color:orange">__id__</span> - *уникальный идентификатор* <br/>
<span style="color:green">__account_id__</span> - *идентификатор счета, которому принадлежит карта* <br/>
__nubmer__ - *номер карты* <br/>
__expiration_date__ - *срок действия* <br/>
__cvv__ - *защитный код* <br/>
__status__ - *текущее состояние карты (активна, заблокирована или прошел срок действия)* <br/>

4) ### Заявка:
<span style="color:orange">__id__</span> - *уникальный идентификатор* <br/>
<span style="color:green">__card_id__</span> - *идентификатор карты из которой будет происходить снятие валюты* <br/>
__amount__ - *планируемая сумма снятия* <br/>
__status__ - *текущее состояние заявки (ожидает, принята, отклонена)*
__create_date__ - *дата создания заявки* <br/>

5) ### Выдача наличных:
<span style="color:orange">__id__</span> - *уникальный идентификатор* <br/>
<span style="color:green">__account_id__</span> - *идентификатор счета, из которого будет происходить снятие* <br/>
<span style="color:green">__withdrawal_request_id__</span> - *идентификатор заявки, которая хранит сумму снятия и карту* <br/>
__create_date__ - *дата выдачи наличных* <br/>

6) ### Операция на пополнение:
<span style="color:orange">__id__</span> - *уникальный идентификатор* <br/>
<span style="color:green">__account_id__</span> - *идентификатор счета, на который будет поступление денег* <br/>
__amount__ - *сумма пополнения* <br/>
__create_date__ - *дата пополнения* <br/>

7) ### Перевод денег:
<span style="color:orange">__id__</span> - *уникальный идентификатор* <br/>
<span style="color:green">__from_account_id__</span> - *счет отправителя* <br/>
<span style="color:green">__to_account_id__</span> - *счет получателя* <br/>
__amount__ - *сумма перевода* <br/>
__create_date__ - *дата перевода* <br/>

<hr/>

__*Задание требует, чтобы можно было привязывать переводы к операциям пополнения, если они еще не привязаны к другим операциям*__

8) ### Таблица, связывающая поступление и перевод денег:
<span style="color:red">__deposit_operation_id__</span> - *идентификатор пополения* <br/>
<span style="color:red">__transfer_id__</span> - *идентификатор перевода* <br/>

<hr/>

## __Пополнение счета__
Обычно поплнение счета происходит из банкомата или же через 3 лицо (зарплата) <br/>
Для того, чтобы пополнить счет, нужно:
1) Указать пополняемый счет
2) Указать сумму пополнения

## __Перевод денег__
Для того, чтобы соверщить перевод, нужно:
1) Получить одобрение заявки на перевод
2) Указать из какого счета будет совершен перевод
3) Указать на какой счет будет совершен перевод
4) Указать сумму перевода

## __Промежуточная таблица__
OperationTransfers нужна для: <br/>
Гибкой связи между переводами и операциями пополнения.<br/>
Учета сложных сценариев (один перевод — несколько пополнений, одно пополнение — несколько переводов).










# __гпт многие-ко-многим:__
1. Когда операция пополнения не входит в промежуточную таблицу?
   Операция пополнения (DepositOperations) не всегда связана с переводом (Transfers). Например:<br/>
Начисление зарплаты: деньги поступают на счет без перевода внутри системы.<br/>
Пополнение через банкомат: пользователь вносит наличные, и деньги зачисляются на счет.<br/>
Внешние платежи: например, пополнение через платежный шлюз (другой банк, электронный кошелек и т. д.).<br/>
В этих случаях операция пополнения не связана с переводом внутри системы, поэтому она не входит в промежуточную таблицу OperationTransfers.<br/>
2. Когда операция пополнения входит в промежуточную таблицу?<br/>
Операция пополнения (DepositOperations) входит в промежуточную таблицу OperationTransfers, только если она связана с переводом внутри системы (Transfers).<br/>
Например:<br/>
Пользователь переводит деньги с одной своей карты (или счета) на другую.<br/>
В этом случае:<br/>
Создается перевод (Transfers).<br/>
Создается операция пополнения (DepositOperations).<br/>
Они связываются через промежуточную таблицу OperationTransfers.<br/>
3. Что происходит при создании перевода?<br/>
Сценарий 1: Перевод внутри системы<br/>
Пользователь переводит деньги с одного счета на другой внутри вашей системы.<br/>
В этом случае:<br/>
Создается перевод (Transfers):<br/>
INSERT INTO Transfers (from_account_id, to_account_id, amount)<br/>
VALUES (2, 1, 1000.00); -- from_account_id = 2, to_account_id = 1, amount = 1000<br/>
Создается операция пополнения (DepositOperations):<br/>
INSERT INTO DepositOperations (account_id, amount)<br/>
VALUES (1, 1000.00); -- account_id = 1, amount = 1000<br/>
Они связываются через промежуточную таблицу OperationTransfers:<br/>
INSERT INTO OperationTransfers (operation_id, transfer_id)<br/>
VALUES (1, 1); -- operation_id = 1, transfer_id = 1<br/>
Сценарий 2: Перевод из внешней системы<br/>
Пользователь переводит деньги из внешней системы (например, с карты другого банка) на счет в вашей системе.<br/>
В этом случае:<br/>
Создается перевод (Transfers):<br/>
INSERT INTO Transfers (to_account_id, amount)<br/>
VALUES (1, 1000.00); -- to_account_id = 1, amount = 1000<br/>
Создается операция пополнения (DepositOperations):<br/>
INSERT INTO DepositOperations (account_id, amount)<br/>
VALUES (1, 1000.00); -- account_id = 1, amount = 1000<br/>
Они связываются через промежуточную таблицу OperationTransfers:<br/>
INSERT INTO OperationTransfers (operation_id, transfer_id)<br/>
VALUES (1, 1); -- operation_id = 1, transfer_id = 1<br/>
4. Почему нельзя просто сделать перевод без промежуточной таблицы?<br/>
Разделение ответственности:<br/>
Перевод (Transfers) — это операция перемещения денег.<br/>
Пополнение (DepositOperations) — это операция зачисления денег на счет.<br/>
Они могут существовать независимо друг от друга, и их связь через промежуточную таблицу позволяет учитывать сложные сценарии.<br/>
Гибкость:<br/>
Один перевод может быть связан с несколькими операциями пополнения.<br/>
Одна операция пополнения может быть связана с несколькими переводами.<br/>
Соответствие заданию:<br/>
Задание требует, чтобы можно было привязывать переводы к операциям пополнения, если они еще не привязаны к другим операциям.<br/>
Без промежуточной таблицы это невозможно реализовать.<br/>
5. Итог:<br/>
Операция пополнения (DepositOperations):<br/>
Может существовать без перевода (например, начисление зарплаты, пополнение через банкомат).<br/>
Если она связана с переводом внутри системы, то входит в промежуточную таблицу OperationTransfers.<br/>
Перевод (Transfers):<br/>
Если перевод происходит внутри системы, то он связан с операцией пополнения через промежуточную таблицу.<br/>
Если перевод происходит из внешней системы, то он также связан с операцией пополнения через промежуточную таблицу.<br/>
Промежуточная таблица OperationTransfers:<br/>
Нужна для гибкой связи между переводами и операциями пополнения.<br/>
Позволяет учитывать сложные сценарии (один перевод — несколько пополнений, одно пополнение — несколько переводов).<br/>
